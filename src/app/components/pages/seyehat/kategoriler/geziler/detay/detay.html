<div class="create-wrapper">

  <!-- Y√ºkleniyor / Hata -->
  @if (loading) {
    <div class="title-panel" aria-live="polite">
      <div class="hint">Y√ºkleniyor‚Ä¶</div>
    </div>
  }

  @if (error) {
    <div class="title-panel" aria-live="assertive">
      <div class="error">‚ùå {{ error }}</div>
    </div>
  }

  @if (!loading && !error && ilan) {

    <!-- ===== ƒ∞lan Sahibi ===== -->
    <div class="title-panel user-bar">
      <div class="user-avatar">{{ ownerInitial }}</div>
      <div class="user-meta">
        <div class="user-name">{{ ownerName }}</div>
      </div>
    </div>

    <!-- ===== Ba≈ülƒ±k ===== -->
    <div class="pill">Ba≈ülƒ±k</div>
    <div class="title-panel">
      <div class="title-input display-field">
        {{ ilan.title }}
      </div>
    </div>

    <!-- ===== A√ßƒ±klama ===== -->
    <div class="pill pill-sp">A√ßƒ±klama</div>
    <div class="title-panel">
      <div class="title-input display-field text-pre">
        {{ ilan.description }}
      </div>
    </div>

    <!-- ===== Konum / Tarih / Saat (aynƒ± satƒ±r) ===== -->
    <div class="pill pill-sp">Bilgiler</div>
    <div class="title-panel">
      <div class="info-row">
        <div class="title-input display-field">
          <div class="field-label field-label-sp">Konum</div>
          <div>{{ locationText }}</div>
        </div>
        <div class="title-input display-field">
          <div class="field-label field-label-sp">Tarih</div>
          <div>{{ dateText }}</div>
        </div>
        <div class="title-input display-field">
          <div class="field-label field-label-sp">Saat</div>
          <div>{{ timeText }}</div>
        </div>
      </div>
    </div>

    <!-- ===== Bildirim Butonu ===== -->
    <button
      class="found-btn"
      type="button"
      (click)="onSeniBuldum()"
      [disabled]="loading || sending || !(ilan && ilan.id)">
      {{ sending ? 'G√∂nderiliyor‚Ä¶' : 'üí¨ Seni buldum' }}
    </button>

    <!-- ===== ƒ∞≈ülem Sonrasƒ± Mesajlar ===== -->
    @if (sendErr) {
      <div class="msg err" aria-live="assertive">{{ sendErr }}</div>
    }

    @if (sendOk && !sendErr && !hasNewBadges) {
      <div class="msg ok" aria-live="polite">Bildirim g√∂nderildi ‚úÖ</div>
    }

    <!-- ===== Yeni Kazanƒ±lan Rozetler ===== -->
    @if (hasNewBadges) {
      <div class="pill pill-sp mt-2">Yeni Rozetlerin</div>
      <div class="title-panel">
        <div class="badges-list">
          @for (b of newlyAwarded; track b.code) {
            <div class="badge-item">
              @if (b.iconUrl) {
                <img [src]="b.iconUrl" alt="rozet" width="20" height="20" />
              }
              <span class="badge-text">{{ b.name || b.badgeName || b.code }}</span>
              @if (b.awardedAt) {
                <small class="badge-time">({{ b.awardedAt | date:'short' }})</small>
              }
            </div>
          }
        </div>
      </div>
    }
  }
</div>
