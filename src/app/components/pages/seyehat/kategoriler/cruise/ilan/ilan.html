<div class="create-wrapper">
  <!-- Kullanıcı çubuğu -->
  <div class="user-bar" *ngIf="user as u">
    <div class="avatar"><span>{{ (u.fullName || 'U').charAt(0) }}</span></div>
    <div class="user-meta">
      <div class="name">{{ u.fullName }}</div>
      <div class="sub">Kayıt Tarihi: {{ u.joinedAt | date:'d MMMM y' }}</div>
    </div>
  </div>

  <!-- Başlık -->
  <div class="pill-title">İlan Başlığı</div>
  <div class="title-panel">
    <input
      class="title-input"
      type="text"
      name="title"
      [(ngModel)]="title"
      [attr.maxlength]="maxTitleLen"
      required
      placeholder="Etkinlik başlığını girin (örn: Hafta Sonu Trekking Turu)"
      aria-describedby="titleHelp titleCount"
    />
    <div id="titleHelp" class="hint">Kısa ve net bir başlık yaz.</div>
    <div id="titleCount" class="char-count">{{ title.length }}/{{ maxTitleLen }}</div>
  </div>

  <!-- Açıklama -->
  <div class="pill-title">Açıklama</div>
  <div class="desc-panel">
    <textarea
      class="desc-input"
      name="description"
      [(ngModel)]="description"
      [attr.maxlength]="maxDescLen"
      rows="4"
      required
      placeholder="Etkinlik hakkında detaylı bilgi verin. Nerede, ne zaman, kimlerle, ne yapılacak?"
      aria-describedby="descHelp descCount"
    ></textarea>
    <div id="descHelp" class="hint">
      Katılımcıların doğru beklentiye sahip olması için mümkün olduğunca detay ekleyin.
    </div>
    <div id="descCount" class="char-count">{{ description.length }}/{{ maxDescLen }}</div>
  </div>

  <!-- Konum -->
  <div class="pill-title">Konum</div>
  <div class="location-panel">
    <!-- Şehir -->
    <mat-form-field class="city-field" appearance="outline">
      <mat-label>Şehir</mat-label>
      <input
        matInput
        name="city"
        placeholder="Örn: Ankara"
        [(ngModel)]="cityQuery"
        (input)="filterCities()"
        [matAutocomplete]="cityAuto"
        required
        aria-autocomplete="list"
      />
      <mat-autocomplete #cityAuto="matAutocomplete" (optionSelected)="onCitySelected($event.option.value)">
        <mat-option *ngFor="let c of filteredCities" [value]="c">{{ c }}</mat-option>
        <mat-option *ngIf="filteredCities.length === 0" [disabled]="true">Sonuç yok</mat-option>
      </mat-autocomplete>
    </mat-form-field>

    <!-- İlçe -->
    <mat-form-field class="district-field" appearance="outline">
      <mat-label>İlçe</mat-label>
      <input
        matInput
        name="district"
        placeholder="İlçe yazın"
        [(ngModel)]="districtQuery"
        (input)="filterDistricts()"
        [matAutocomplete]="districtAuto"
        [disabled]="!selectedCity"
        required
        aria-autocomplete="list"
      />
      <mat-autocomplete #districtAuto="matAutocomplete" (optionSelected)="onDistrictSelected($event.option.value)">
        <mat-option *ngFor="let d of filteredDistricts" [value]="d">{{ d }}</mat-option>
        <mat-option *ngIf="selectedCity && filteredDistricts.length === 0" [disabled]="true">Sonuç yok</mat-option>
      </mat-autocomplete>
    </mat-form-field>
  </div>

    <!-- Tarih & Saat -->
  <div class="pill-title">Tarih & Saat</div>
  <div class="date-time-panel">
    <!-- Tarih (takvim) -->
    <mat-form-field appearance="outline" class="date-field">
      <mat-label>Tarih</mat-label>
      <input
        matInput
        name="selectedDate"
        [matDatepicker]="picker"
        [(ngModel)]="selectedDate"
        [min]="minDate"
        placeholder="Tarih seçin"
        required
      />
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker startView="multi-year" touchUi="true"></mat-datepicker>
    </mat-form-field>

    <!-- Saat -->
    <div class="time-select">
      <select name="selectedTime" [(ngModel)]="selectedTime" required autocomplete="off">
        <option [ngValue]="null" disabled selected>Saat</option>
        <option *ngFor="let t of times" [ngValue]="t" [disabled]="isPastTimeOnSelectedDate(t)">
          {{ t }}
        </option>
      </select>
    </div>
  </div>

  <!-- Yayınla -->
  <div class="actions">
    <button
  type="button"
  class="ellipse-btn"
  (click)="goToDetail()"
  [disabled]="loading">
  {{ loading ? 'Gönderiliyor...' : 'Bul Beni' }}
</button>

  </div>
</div> <!-- create-wrapper kapanışı -->
