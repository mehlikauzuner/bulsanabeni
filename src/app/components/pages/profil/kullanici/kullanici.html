<pre style="position:fixed;bottom:80px;right:16px;color:#fff;opacity:.6">
  sendOk={{sendOk}} tab={{activeTab}}
</pre>

<div class="page">
  <section class="card">
    <!-- Header -->
    <header class="header">
      <button class="back" (click)="goBack()" aria-label="Geri">âŸµ</button>
      <h1 class="sr-only">KullanÄ±cÄ± Profili</h1>
    </header>

    <!-- Profil Ã¼st blok -->
    <div class="profile">
      <div class="avatar"><span class="initial">{{ initialLetter }}</span></div>
      <div class="username-pill">{{ displayName }}</div>
      <div class="city">{{ user.city }}</div>
      <div class="rating"><span>â˜…</span> {{ user.ratingAvg ?? 0 }} <small>({{ user.ratingCount ?? 0 }})</small></div>
    </div>

    <!-- Tabs -->
    <nav class="tabs">
      <button [class.active]="activeTab==='rozetler'" (click)="setTab('rozetler')">Rozetler</button>
      <button [class.active]="activeTab==='yorumlar'" (click)="setTab('yorumlar')">Yorumlar</button>
      <button [class.active]="activeTab==='mesaj'"     (click)="setTab('mesaj')">Mesaj GÃ¶nder</button>
    </nav>

    <!-- Ä°Ã§erik -->
    <section class="content">
      <!-- Rozetler -->
      <div *ngIf="activeTab==='rozetler'">
        <div class="badge-row">
          <div class="badge" *ngFor="let b of badges" [title]="b.name">
            <div class="icon">{{ b.icon }}</div>
            <div class="label">{{ b.name }}</div>
          </div>
        </div>
      </div>

<!-- YORUMLAR SEKME Ä°Ã‡ERÄ°ÄžÄ° -->
<div *ngIf="activeTab === 'yorumlar'" class="mt-3">

  <!-- Yorum yaz kutusu -->
  <div class="card mb-3">
    <div class="card-body">
      <label class="form-label fw-semibold">Yorum yaz</label>
      <textarea class="form-control" rows="3"
                [disabled]="isCommentSending"
                (input)="onCommentInput($event)"
                (keydown.control.enter)="sendComment()"
                placeholder="DÃ¼ÅŸÃ¼nceni yaz (Ctrl/Cmd + Enter ile gÃ¶nder)">
      </textarea>

      <div class="d-flex align-items-center gap-2 mt-2">
        <button class="btn btn-primary"
                [disabled]="isCommentSending || !commentText.trim()"
                (click)="sendComment()">
          GÃ¶nder
        </button>
        <span *ngIf="commentSendOk" class="text-success small">Yorum gÃ¶nderildi.</span>
      </div>
    </div>
  </div>

  <!-- Yorum listesi -->
  <div *ngIf="isCommentsLoading" class="text-muted">Yorumlar yÃ¼kleniyorâ€¦</div>
  <div *ngIf="!isCommentsLoading && comments.length === 0" class="text-muted">
    HenÃ¼z yorum yok.
  </div>

  <div class="list-group">
    <div class="list-group-item bg-transparent border-0 p-0 mb-3"
         *ngFor="let c of comments">
      <div class="card">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-center">
            <strong>{{ c.authorName }}</strong>
            <small class="text-muted">{{ c.createdAt | date:'short' }}</small>
          </div>
          <div class="mt-2">
            {{ c.content }}
          </div>
        </div>
      </div>
    </div>
  </div>

</div>



      <!-- Mesaj -->
      <div *ngIf="activeTab==='mesaj'">
        <div *ngIf="showComposer" class="message-box">
          <textarea
            id="mesajTextarea"
            [value]="messageText"
            (input)="onMessageInput($event)"
            (keydown.enter)="sendMessage()"
            placeholder="Mesaj yaz..."></textarea>

          <button class="primary"
                  (click)="sendMessage()"
                  [disabled]="!messageText.trim() || isSending">
            MESAJ GÃ–NDER
          </button>
        </div>

        <button *ngIf="sendOk && !showComposer"
                class="primary"
                (click)="newMessage()">
          ðŸŽ‰ MesajÄ±nÄ±z gÃ¶nderildi
        </button>
      </div>
    </section>
  </section>
</div>