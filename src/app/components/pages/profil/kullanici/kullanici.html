<pre style="position:fixed;bottom:80px;right:16px;color:#fff;opacity:.6">
  sendOk={{sendOk}} tab={{activeTab}}
</pre>

<div class="page">
  <section class="card">
    <!-- Header -->
    <header class="header">
      <button class="back" (click)="goBack()" aria-label="Geri">âŸµ</button>
      <h1 class="sr-only">KullanÄ±cÄ± Profili</h1>
    </header>

    <!-- Profil Ã¼st blok -->
    <div class="profile">
      <div class="avatar"><span class="initial">{{ initialLetter }}</span></div>
      <div class="username-pill">{{ displayName }}</div>
      <div class="city">{{ user.city }}</div>
      <div class="rating"><span>â˜…</span> {{ user.ratingAvg ?? 0 }} <small>({{ user.ratingCount ?? 0 }})</small></div>
    </div>

    <!-- Tabs -->
    <nav class="tabs">
      <button [class.active]="activeTab==='rozetler'" (click)="setTab('rozetler')">Rozetler</button>
      <button [class.active]="activeTab==='yorumlar'" (click)="setTab('yorumlar')">Yorumlar</button>
      <button [class.active]="activeTab==='mesaj'"     (click)="setTab('mesaj')">Mesaj GÃ¶nder</button>
    </nav>

    <!-- Ä°Ã§erik -->
    <section class="content">
      <!-- Rozetler -->
      <div *ngIf="activeTab==='rozetler'">
        <div class="badge-row">
          <div class="badge" *ngFor="let b of badges" [title]="b.name">
            <div class="icon">{{ b.icon }}</div>
            <div class="label">{{ b.name }}</div>
          </div>
        </div>
      </div>

      <!-- Yorumlar -->
      <div *ngIf="activeTab==='yorumlar'">
        <article class="review" *ngFor="let r of reviews">
          <div class="review-head">
            <strong>{{ r.author }}</strong>
            <span class="when">{{ r.when }}</span>
          </div>
          <p class="text">{{ r.text }}</p>
        </article>
      </div>

      <!-- Mesaj -->
      <div *ngIf="activeTab==='mesaj'">
        <div *ngIf="showComposer" class="message-box">
          <textarea
            [value]="messageText"
            (input)="onMessageInput($event)"
            (keydown.enter)="sendMessage()"
            placeholder="Mesaj yaz..."></textarea>

          <button class="primary"
                  (click)="sendMessage()"
                  [disabled]="!messageText.trim() || isSending">
            MESAJ GÃ–NDER
          </button>
        </div>

        <button *ngIf="sendOk && !showComposer"
                class="primary"
                (click)="newMessage()">
          ðŸŽ‰ MesajÄ±nÄ±z gÃ¶nderildi
        </button>
      </div>
    </section>
  </section>
</div>